<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Pre-enseñanza_B</title>
<link rel="stylesheet" href="estilosIgualacionAuditiva.css"/>

<script>
var m="B";
var n=1;  //ensayos (de 1 a 20)
var b=2;    //Último botón bulsado (izqu=1, der=0)
var c=0; //próximo gif a mostrar

var gif=[
"imagenes/gifs/gif001.gif",
"imagenes/gifs/gif002.gif",
"imagenes/gifs/gif003.gif",
"imagenes/gifs/gif004.gif",
"imagenes/gifs/gif005.gif",
"imagenes/gifs/gif006.gif",
"imagenes/gifs/gif007.gif",
"imagenes/gifs/gif008.gif",
"imagenes/gifs/gif009.gif",
"imagenes/gifs/gif010.gif",
"imagenes/gifs/gif011.gif",
"imagenes/gifs/gif012.gif",
"imagenes/gifs/gif013.gif",
"imagenes/gifs/gif014.gif",
"imagenes/gifs/gif015.gif",
"imagenes/gifs/gif016.gif",
"imagenes/gifs/gif017.gif",
"imagenes/gifs/gif018.gif",
"imagenes/gifs/gif019.gif",
"imagenes/gifs/gif020.gif",
"imagenes/gifs/gif021.gif",
"imagenes/gifs/gif022.gif",
"imagenes/gifs/gif023.gif",
"imagenes/gifs/gif024.gif",
"imagenes/gifs/gif025.gif",
"imagenes/gifs/gif026.gif",
"imagenes/gifs/gif027.gif",
"imagenes/gifs/gif028.gif",
"imagenes/gifs/gif029.gif",
"imagenes/gifs/gif030.gif"
]


function comenzar(){
document.getElementById('gif').src=gif[c];
let imagen=[
["imagenes/pre_ensenanza/pajaro.png",
"imagenes/pre_ensenanza/agua.png",
"imagenes/pre_ensenanza/gato.png",
"imagenes/pre_ensenanza/reloj.png",
"imagenes/pre_ensenanza/abeja.png",
"imagenes/pre_ensenanza/campana.png",
"imagenes/pre_ensenanza/lobo.png",
"imagenes/pre_ensenanza/coche.png",
"imagenes/pre_ensenanza/buho.png",
"imagenes/pre_ensenanza/cochepolicia.png"],
["imagenes/pre_ensenanza/ballena.png",
"imagenes/pre_ensenanza/perro.png",
"imagenes/pre_ensenanza/tocpuerta.png",
"imagenes/pre_ensenanza/zambullir.png",
"imagenes/pre_ensenanza/caballo.png",
"imagenes/pre_ensenanza/gallo.png",
"imagenes/pre_ensenanza/avion.png",
"imagenes/pre_ensenanza/martilloneum.png",
"imagenes/pre_ensenanza/disco.png",
"imagenes/pre_ensenanza/timbrecasa.png"]
]


let audio =[  
  [document.getElementById('f1a4'),
  document.getElementById('f1a1'),
  document.getElementById('f1a5'),
  document.getElementById('f2a1'),
  document.getElementById('f2a4'),  
  document.getElementById('f2a2'),
  document.getElementById('f2a5'),
  document.getElementById('f3a2'),
  document.getElementById('f3a4'),
  document.getElementById('f4b1')],
  [document.getElementById('f3a5'),
  document.getElementById('f3b5'),
  document.getElementById('f3a3'),
  document.getElementById('f4b3'),
  document.getElementById('f4b4'),
  document.getElementById('f4b5'),
  document.getElementById('f3b4'),
  document.getElementById('f3b3'),
  document.getElementById('f3b1'),
  document.getElementById('f1a2')]
  ]


//ajuste de los volúmenes de los audios para que suenen todos iguales.

audio[0][0].volume=0.3;
audio[0][1].volume=0.3;
audio[0][2].volume=0.3;
audio[0][3].volume=1;
audio[0][4].volume=0.4;


audio[0][5].volume=0.3;
audio[0][6].volume=0.3;
audio[0][7].volume=0.3;
audio[0][8].volume=0.7;
audio[0][9].volume=0.3;


audio[1][0].volume=0.6;
audio[1][1].volume=0.8;
audio[1][2].volume=0.6;
audio[1][3].volume=0.3;
audio[1][4].volume=0.6;

audio[1][5].volume=0.7;
audio[1][6].volume=0.4;
audio[1][7].volume=0.3;
audio[1][8].volume=0.7;
audio[1][9].volume=0.3;


let choose = Math.round(Math.random(1));


if(choose==0){
  choose1=4}else{
  choose1=-1;
  }

if(choose==0){
  choose2=-1}else{
  choose2=4;
  }


  document.getElementById('dibu1').src=imagen[positivos[1][n-1]][orden[0][n-1]+choose1];

  if(positivos[0][n-1]==0){
    document.getElementById('dibu2').src=imagen[positivos[1][n-1]][orden[0][n-1]+choose1];
  }else{
    document.getElementById('dibu3').src=imagen[positivos[1][n-1]][orden[0][n-1]+choose1];
  }


  if(positivos[0][n-1]==1){
    document.getElementById('dibu2').src=imagen[1-positivos[1][n-1]][orden[1][n-1]+choose2];
  }else{
    document.getElementById('dibu3').src=imagen[1-positivos[1][n-1]][orden[1][n-1]+choose2];
  }  


let btn2 = function(){
  b=0;
  if(positivos[0][n-1]==0){
  audio[positivos[1][n-1]][orden[0][n-1]+choose1].currentTime=0;
  audio[positivos[1][n-1]][orden[0][n-1]+choose1].play();
  }else {
  audio[1-positivos[1][n-1]][orden[1][n-1]+choose2].currentTime=0;
  audio[1-positivos[1][n-1]][orden[1][n-1]+choose2].play();
}
}

let btn3 = function(){
  b=1;
  if(positivos[0][n-1]==1){
  audio[positivos[1][n-1]][orden[0][n-1]+choose1].currentTime=0;
  audio[positivos[1][n-1]][orden[0][n-1]+choose1].play();
  }else {
  audio[1-positivos[1][n-1]][orden[1][n-1]+choose2].currentTime=0;
  audio[1-positivos[1][n-1]][orden[1][n-1]+choose2].play();
}
}

document.getElementById('bt1').style.background="#89f7fe";
document.getElementById('bt2').style.background="#89f7fe";
document.getElementById('bt3').style.background="#89f7fe";

document.getElementById("nensayo").value=n;

document.getElementById('resultado').addEventListener("click",result,false); 

document.getElementById('dibu1').addEventListener("mouseover",function(){document.getElementById('bt1').style.background="#ffd700";},false);

document.getElementById('dibu1').addEventListener("mouseout",function(){document.getElementById('bt1').style.background="#89f7fe";},false);

document.getElementById('dibu1').addEventListener("click",function(){audio[positivos[1][n-1]][orden[0][n-1]+choose1].currentTime=0;audio[positivos[1][n-1]][orden[0][n-1]+choose1].play();},false);

document.getElementById('dibu2').addEventListener("mouseover",function(){document.getElementById('bt2').style.background="#ffd700";},false);

document.getElementById('dibu2').addEventListener("mouseout",function(){document.getElementById('bt2').style.background="#89f7fe";},false);

document.getElementById('dibu3').addEventListener("mouseover",function(){document.getElementById('bt3').style.background="#ffd700";},false);

document.getElementById('dibu3').addEventListener("mouseout",function(){document.getElementById('bt3').style.background="#89f7fe";},false);

document.getElementById('dibu2').addEventListener("click",btn2,false);

document.getElementById('dibu3').addEventListener("click",btn3,false);

document.getElementById('nensayo').addEventListener("input",function(){n=parseInt(document.getElementById('nensayo').value); comenzar();},false);

document.getElementById("nfase").value=m;

document.getElementById("gif").style.zIndex = "1";

document.getElementById('fi').addEventListener("click",fmenos,false);
document.getElementById('fd').addEventListener("click",fmas,false);
document.getElementById('ei').addEventListener("click",emenos,false);
document.getElementById('ed').addEventListener("click",emas,false);


/*final proceso para cada ensayo*/

}/*final funcion comenzar*/

function fmas(){  
    location.replace("IgualacionAuditiva.html"); 
  }
  

function fmenos(){     
  location.replace("Pre-enseñanza_A.html"); 
}

function emas(){ 
  if(n==20){
    return 0;
  }else {
    n++;
  }
  comenzar();
}

function emenos(){  
  if(n==1){
    return 0;
  }else {
    n--;
  }  
  comenzar();
}


function result(){

victoria();

  if (n==20){
    return 0;
  }else{
    n++;
    comenzar();
  }  
}


function victoria(){
    if (b==positivos[0][n-1]){
    document.getElementById('muybien').play();    
    document.getElementById('gif').style.visibility="visible";    
    setTimeout(function(){
      document.getElementById('gif').style.visibility="hidden";
      if (c==29){
        c=0;
      }else {
        c++;    
      }
    }, 3000);
    
  } 
  b=2;
}

//----------------------------------------------------------------------------------------------------------------------
var orden=(function(){

let orden= [[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];

/*principio del bucle for externo*/
for (let g=0; g<11; g++){
  orden[g]=ordeni();
}

return orden;

function ordeni(){
let orden1=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
let quedan=[4,4,4,4,4];
let eleccion=[1,2,3,4,5]; 

/*principio del bucle for medio*/
for (let j = 0; j < orden1.length; j++) {
  
orden1[j]=eleccion[Math.round((eleccion.length-1)*Math.random())];

eleccion=[1,2,3,4,5];

let index = eleccion.indexOf(orden1[j]);

--quedan[index];

/*principio del bucle for interno*/
for (let i = quedan.length-1; i >= 0; i--) {
  
  if (eleccion[i]==orden1[j] || quedan[i]==0 || ((4-quedan[i])/(j+1))>0.2) {
    
    eleccion.splice(i,1);
  }
}/*final del bucle for interno*/
}/*final del bucle for medio*/
return orden1;
}/*final del bucle for externo*/
}())/*final funcion ordenAudios*/
//----------------------------------------------------------------------------------------------------------------------
  

//----------------------------------------------------------------------------------------------------------------------
var positivos=(function(){
 
let positivos=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]; 

/*principio del bucle for externo*/
for (let g=0; g<11; g++){

  positivos[g]=positivosi();
}

return positivos;

function positivosi(){
let positivos1=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
let restan=[10,10]; 
let elegir=[0,1];

/*principio del bucle for medio*/
for (let j = 0; j < positivos1.length; j++) {
  
positivos1[j]=elegir[Math.round((elegir.length-1)*Math.random())];

elegir=[0,1];

let index = elegir.indexOf(positivos1[j]);

--restan[index];

/*principio del bucle for interno*/
for (let i = restan.length-1; i >= 0; i--) {
  
  if (/*(elegir[i]==positivos[j] && elegir[i]==positivos[j-1]) ||*/ restan[i]==0 || ((10-restan[i])/(j+1))>0.55) {
    
    elegir.splice(i,1);
  }
}/*final del bucle for interno*/
}/*final del bucle for medio*/
return positivos1;
}/*final del bucle for externo*/
}())/*final funcion repatro positivos*/
//----------------------------------------------------------------------------------------------------------------------




 
window.addEventListener("load",comenzar,false);


 
  


</script>

</head>


<body>

<audio src="audios/f1a4.mp3" id="f1a4">Su navegador no soporta este audio</audio>
<audio src="audios/f1a1.mp3" id="f1a1">Su navegador no soporta este audio</audio>
<audio src="audios/f1a5.mp3" id="f1a5">Su navegador no soporta este audio</audio>
<audio src="audios/f2a1.mp3" id="f2a1">Su navegador no soporta este audio</audio>
<audio src="audios/f2a4.mp3" id="f2a4">Su navegador no soporta este audio</audio>

<audio src="audios/f2a2.mp3" id="f2a2">Su navegador no soporta este audio</audio>
<audio src="audios/f2a5.mp3" id="f2a5">Su navegador no soporta este audio</audio>
<audio src="audios/f3a2.mp3" id="f3a2">Su navegador no soporta este audio</audio>
<audio src="audios/f3a4.mp3" id="f3a4">Su navegador no soporta este audio</audio>
<audio src="audios/f4b1.mp3" id="f4b1">Su navegador no soporta este audio</audio>



<audio src="audios/f3a5.mp3" id="f3a5">Su navegador no soporta este audio</audio>
<audio src="audios/f3b5.mp3" id="f3b5">Su navegador no soporta este audio</audio>
<audio src="audios/f3a3.mp3" id="f3a3">Su navegador no soporta este audio</audio>
<audio src="audios/f4b3.mp3" id="f4b3">Su navegador no soporta este audio</audio>
<audio src="audios/f4b4.mp3" id="f4b4">Su navegador no soporta este audio</audio>

<audio src="audios/f4b5.mp3" id="f4b5">Su navegador no soporta este audio</audio>
<audio src="audios/f3b4.mp3" id="f3b4">Su navegador no soporta este audio</audio>
<audio src="audios/f3b3.mp3" id="f3b3">Su navegador no soporta este audio</audio>
<audio src="audios/f3b1.mp3" id="f3b1">Su navegador no soporta este audio</audio>
<audio src="audios/f1a2.mp3" id="f1a2">Su navegador no soporta este audio</audio>






<audio src="audios/muybien.mp3" id="muybien">Su navegador no soporta este audio</audio>


<img src="imagenes/giphy.gif" id="gif"></img>

<button class="redondos" id="bt1"></button> 
<button class="redondos" id="bt2""></button>
<button class="redondos" id="bt3"></button>

<img class="dibus" id="dibu1" preload>
<img class="dibus" id="dibu2" preload>
<img class="dibus" id="dibu3" preload>


<aside id="fase">Fase <output type="text" id="nfase"></output></aside>
<aside id="ensayo">Ensayo <output type="text" id="nensayo"></output></aside>
<button id="resultado">Resultado</button>
<div id="raya"></div>

<button class="flechas" id="ed">></button>
<button class="flechas" id="ei"><</button>
<button class="flechas" id="fd">></button>
<button class="flechas" id="fi"><</button>






</body>
</html>